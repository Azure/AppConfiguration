{
    "definitions": {},
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://azconfig.io/schemas/FeatureManagement/v2.0.0/FeatureFlag.json",
    "type": "object",
    "title": "An Azure App Configuration Feature Declaration",
    "required": [
      "id",
      "enabled",
      "conditions"
    ],
    "properties": {
      "id": {
        "$id": "#/properties/id",
        "type": "string",
        "title": "Feature ID",
        "description": "An ID used to uniquely identify and reference the feature.",
        "examples": [
          "fancy-background"
        ],
        "pattern": "^(.*)$"
      },
      "description": {
        "$id": "#/properties/description",
        "type": "string",
        "title": "Feature Description",
        "description": "A description of the feature.",
        "default": "",
        "examples": [
          "This will display a fancy background on the home page."
        ],
        "pattern": "^[a-zA-Z0-9_\\-\\.]*$"
      },
      "display_name": {
        "$id": "#/properties/display_name",
        "type": "string",
        "title": "Feature Display Name",
        "description": "A display name for the feature to use for display rather than the ID.",
        "default": "",
        "examples": [
          "Fancy Background"
        ],
        "pattern": "^(.*)$"
      },
      "enabled": {
        "$id": "#/properties/enabled",
        "type": "boolean",
        "title": "Enabled State",
        "description": "A feature is OFF if enabled is false. If enabled is true, then the feature is ON if there are no conditions (null or empty) or if all conditions are satisfied.",
        "default": false
      },
      "conditions": {
        "$id": "#/properties/conditions",
        "type": "object",
        "title": "Feature Enablement Conditions",
        "description": "The declaration of conditions used to dynamically enable features.",
        "required": [],
        "properties": {
          "requirement_type": {
            "$id": "#/properties/conditions/properties/requirement_type",
            "type": "string",
            "title": "Requirement Type",
            "description": "Determines whether any or all registered client filters must be enabled for the feature to be considered enabled.",
            "enum": [
              "Any",
              "All"
            ],
            "default": "Any"
          },
          "client_filters": {
            "$id": "#/properties/conditions/properties/client_filters",
            "type": "array",
            "title": "Client Filter Collection",
            "description": "Filters that must run on the client and be evaluated as true for the feature to be considered enabled.",
            "items": {
              "$id": "#/properties/conditions/properties/client_filters/items",
              "type": "object",
              "title": "Client Filter",
              "required": [
                "name"
              ],
              "properties": {
                "name": {
                  "$id": "#/properties/conditions/properties/client_filters/items/properties/name",
                  "type": "string",
                  "title": "Client Filter Name",
                  "description": "The name used to refer to and require a client filter.",
                  "default": "",
                  "examples": [
                    "Percentage",
                    "TimeWindow"
                  ],
                  "pattern": "^(.*)$"
                },
                "parameters": {
                  "$id": "#/properties/conditions/properties/client_filters/items/properties/parameters",
                  "type": "object",
                  "title": "Client Filter Parameters",
                  "description": "Custom parameters for a given client filter. A client filter can require any set of parameters of any type.",
                  "required": [],
                  "patternProperties": {
                    "^.*$": {
                      "anyOf": [
                        {
                          "type": "string"
                        },
                        {
                          "type": "null"
                        },
                        {
                          "type": "object"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "array"
                        },
                        {
                          "type": "boolean"
                        }
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          }
        }
      },
      "variants": {
        "$id": "#/properties/variants",
        "type": "array",
        "title": "Feature Variants Collection",
        "description": "The list of variants defined for this feature. A variant represents a value of a feature flag that can be a string, a number, a boolean, or even a configuration object",
        "items": {
            "$id": "#/properties/variants/items",
            "type": "object",
            "title": "Feature Variant",
            "required": [
                "name"
            ],
            "properties":{
                "name": {
                    "$id": "#/properties/variants/items/properties/name",
                    "type": "string",
                    "title": "Feature Variant Name",
                    "description": "The name used to refer to a feature variant.",
                    "default": "",
                    "pattern": "^(.*)$"
                },
                "configuration_value": {
                    "$id": "#/properties/variants/items/properties/configuration_value",
                    "title": "Feature Variant Configuration Value",
                    "description": "The configuration value for a feature variant."
                },
                "configuration_reference": {
                    "$id": "#/properties/variants/items/properties/configuration_reference",
                    "type": "string",
                    "title": "Feature Variant Configuration Reference",
                    "description": "The string used to reference a path in the configuration and set that path's value as the variant's value.",
                    "default": "",
                    "pattern": "^[a-zA-Z0-9]+(:[a-zA-Z0-9]+)*$"
                },
                "status_override": {
                    "$id": "#/properties/variants/items/properties/status_override",
                    "type": "string",
                    "title": "Feature Variant Status Override",
                    "description": "Overrides the enabled state of the feature according to this value, where Enabled is true and Disabled is false. Does not override the state if value is None.",
                    "enum": [
                        "None",
                        "Enabled",
                        "Disabled"
                    ],
                    "default": "None"
                }
            }
        }
      },
      "allocation": {
        "$id": "#/properties/allocation",
        "type": "object",
        "title": "Feature Variant Allocation",
        "description": "Determines how variants should be allocated for the feature to various users.",
        "required": [],
        "properties": {
            "default_when_disabled": {
                "$id": "#/properties/allocation/properties/default_when_disabled",
                "type": "string",
                "title": "Default When Disabled",
                "description": "Specifies which variant should be used when a variant is requested while the feature is considered disabled",
                "default": "",
                "pattern": "^(.*)$"
            },
            "default_when_enabled": {
                "$id": "#/properties/allocation/properties/default_when_enabled",
                "type": "string",
                "title": "Default When Enabled",
                "description": "Specifies which variant should be used when a variant is requested while the feature is considered enabled",
                "default": "",
                "pattern": "^(.*)$"
            },
            "user": {
                "$id": "#/properties/allocation/properties/user",
                "type": "array",
                "title": "User Allocation Collection",
                "description": "A list of objects each containing a variant name and list of users for which that variant should be used.",
                "items": {
                    "$id": "#/properties/allocation/properties/user/items",
                    "type": "object",
                    "title": "User Allocation",
                    "required": [
                        "variant",
                        "users"
                    ],
                    "properties": {
                        "variant": {
                            "$id": "#/properties/allocation/properties/user/items/properties/variant",
                            "type": "string",
                            "title": "User Allocation Variant",
                            "description": "The name of the variant to use if the user allocation matches the current user.",
                            "default": "",
                            "pattern": "^(.*)$"
                        },
                        "users": {
                            "$id": "#/properties/allocation/properties/user/items/properties/users",
                            "type": "array",
                            "title": "User Allocation Users Collection",
                            "description": "The name of the variant to use if the user allocation matches the current user.",
                            "items": {
                                "type": "string"
                            }
                        }
                    }
                }

            },
            "group": {
                
            },
            "percentile": {
                
            },
            "seed": {
                
            }
        }
      },    
      "telemetry_enabled": {
        "$id": "#/properties/telemetry_enabled",
        "type": "boolean",
        "title": "Feature Telemetry Enabled State",
        "description": "",
        "default": true
      },
      "telemetry_metadata": {
        "$id": "#/properties/telemetry_metadata",
        "type": "object",
        "title": "Feature Telemetry Metadata",
        "description": "",
        "patternProperties": {
            ".*": {
              "type": "string"
            }
          },
        "additionalProperties": false
      }
    }
  }